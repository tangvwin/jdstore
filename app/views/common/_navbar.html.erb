<nav class="navbar navbar-inverse" role="navigation">
    <div class="container-fluid">
        <!-- brand and toggle get grouped for better mobile display -->

        <div class="navbar-header">
           <!-- <a class="navbar-brand" href="/"><img src='<%= image_url 'logo.png' %>' ></a> -->
           <a class="navbar-brand" href="/">名机汇</a>

        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active">
                    <%= link_to("全部产品", products_path) %>
                </li>

            </ul>

            <ul class="nav navbar-nav">
                <li class="active">
                    <%= link_to("手机摄影大赛", camera_path) %>
                </li>

            </ul>
            <ul class="nav navbar-nav">
                <li class="active">
                    <%= link_to("about us", about_path) %>
                </li>

            </ul>



            <%= form_tag(search_products_path, method: 'get', class: 'navbar-form navbar-left') do %>
            <%= search_field_tag 'q', nil, class: 'form-control', placeholder: 'Search...'  %>
            <%= submit_tag "搜索", class: 'btn btn-default', :name => nil %>
            <% end %>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <%= link_to carts_path do %>
                    购物车<i class="fa fa-shopping-cart"></i>
                    (<%= current_cart.products.count %>)
                    <% end %>
                </li>

                <% if !current_user %>
                <!-- <li><%= link_to(content_tag(:i,'注册', class: 'fa fa-registered'), new_user_registration_path) %></li>
      <li><%= link_to(content_tag(:i,'登入', class: 'fa fa-sign-in'), new_user_session_path)%></li> -->
                <li>
                    <a href="#" data-toggle="modal" data-target="#signup-modal">注册</a>
                </li>
                <li>
                    <a href="#" data-toggle="modal" data-target="#login-modal">登入</a>
                </li>
                <%else%>
                <li>
    <% if current_user.profile.present? %>
      <%= image_tag(current_user.profile.thumb.url,style:"border-radius:50%;width:50px;height:50px;",class:"thumbnail")  %>
      <!-- 用户的自选头像 -->
    <% else %>
      <%= image_tag("http://ww1.sinaimg.cn/large/006tNbRwgy1ffzxufbo0lj3069069t8o.jpg",class:"thumbnail",style:"width:60px;height:60px;border-radius:50%;") %>
       <!-- 定义用户未选择头像时的默认头像 -->
    <% end %>
</li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                      <% if current_user.name.present?%>
                        Hi!,<%= current_user.name %>
                        <% else %>
                        Hi, <%= current_user.email %>
                        <% end %>
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <% if current_user.admin?%>
                        <li>
                            <%= link_to(content_tag(:i,'Admin Panel', class: 'fa fa-address-card-o'), admin_products_path) %>
                        </li>
                        <% end %>
                        <li>
                            <%= link_to("个人订单列表", account_orders_path) %>
                        </li>
                        <li>
                            <%= link_to("个人资料", account_users_path(current_user)) %>
                        </li>
                        <li>
                            <%= link_to("加强版个人资料", edit_user_registration_path(current_user)) %>
                        </li>
                        <li><%= link_to(content_tag(:i,'登出', class: 'fa fa-sign-out'), destroy_user_session_path, method: :delete) %></li>

                    </ul>
                </li>
                <% end %>

            </ul>
        </div>

    </div>

</nav>

<!-- 以下代码添加在最后 -->
<div class="modal fade" id="login-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" role="document">
        <div class="loginmodal-container">
            <h2>登入</h2>
            <%= simple_form_for(resource, as: resource_name, url: session_path(resource_name)) do |f| %>
            <div class="form-inputs">



                <%= f.input :email, required: false, autofocus: true %>
                <%= f.input :password, required: false %>
                <%= f.input :remember_me, as: :boolean if devise_mapping.rememberable? %>
            </div>
            <div class="form-actions">
                <%= f.button :submit, "Log in" %>
            </div>
            <% end %>
        </div>
    </div>
</div>

<div class="modal fade" id="signup-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="loginmodal-container">
            <h2>用户注册</h2>
            <%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>
            <%= f.error_notification %>
            <div class="form-inputs">
              <%= f.input :name, required: true %>
              <%= f.input :profile, as: :file ,label:"头像"%>

                <%= f.input :email, required: true, autofocus: true %>
                <%= f.input :password, required: true, hint: ("#{@minimum_password_length} characters minimum" if @minimum_password_length) %>
                <%= f.input :password_confirmation, required: true %>
            </div>
            <div class="form-actions">
                <%= f.button :submit, "Sign up" %>
            </div>
            <% end %>
        </div>
    </div>
</div>
